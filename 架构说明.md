# 代码架构说明

## 正确的分析流程

```
1. 数据预处理 (common_utils.py)
   ↓
2. 三种模型分析
   - Logistic回归
   - 决策树
   - 随机森林
   ↓
3. 模型对比 (main_analysis.py)
   ↓
4. 生成报告
```

## 文件说明

### 1. common_utils.py - 公共工具模块
- **DataPreprocessor类**: 负责数据加载和预处理
  - load_data(): 加载Excel数据
  - preprocess_data(): 处理缺失值、编码分类变量、分割数据集
  - 返回预处理后的数据字典

- **ModelEvaluator类**: 负责评估单个模型
  - evaluate_model(): 计算准确率、AUC等指标
  - plot_roc_curve(): 绘制ROC曲线
  - save_results_to_csv(): 保存结果

### 2. main_analysis.py - 主控制脚本
- **MainAnalysisController类**: 协调整个分析流程
  - step1_data_preprocessing(): 执行数据预处理
  - step2_model_analysis(): 调用三种模型分析
  - step3_model_comparison(): 对比模型性能
  - step4_generate_report(): 生成综合报告

### 3. 使用方法

#### 运行完整分析流程
```bash
python main_analysis.py
```

#### 或使用批处理文件
```bash
run_main_analysis.bat
```

## 执行顺序

1. **main_analysis.py** 启动
2. 调用 **common_utils.DataPreprocessor** 进行数据预处理
3. 依次运行三种模型分析（每个模型独立文件）
4. 在 **main_analysis.py** 中进行模型对比
5. 生成综合报告

## 输出文件

- `综合分析报告.md` - 完整的分析报告
- `模型对比结果.csv` - 模型性能对比表
- `模型对比可视化.png` - 性能对比图表
- 各模型的独立分析结果

## 注意事项

- common_utils.py 只包含工具函数，不执行分析
- 模型对比只在 main_analysis.py 中进行
- 每个步骤都有明确的成功/失败判断
- 支持中断后从失败步骤继续