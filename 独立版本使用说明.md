# 独立版本数据分析工具使用说明

## 文件说明

### 三个完全独立的Python文件

1. **logistic_regression_standalone.py** - 多因素Logistic回归分析
2. **decision_tree_standalone.py** - 决策树分析
3. **random_forest_standalone.py** - 随机森林分析

每个文件都是完全独立的，包含了：
- 数据预处理功能
- 模型训练和调优
- 结果评估
- 可视化
- 报告生成

## 使用方法

### 方法1：双击运行批处理文件
- `run_logistic_standalone.bat` - 运行Logistic回归
- `run_decision_tree_standalone.bat` - 运行决策树
- `run_random_forest_standalone.bat` - 运行随机森林

### 方法2：命令行运行
```bash
python logistic_regression_standalone.py
python decision_tree_standalone.py
python random_forest_standalone.py
```

## 数据准备

### 数据文件路径
每个文件中的默认路径是：
```
C:\Users\霍冠华\Desktop\毕设\数据处理\处理后数据_20260104_144216.xlsx
```

如果需要修改，请编辑对应的Python文件，修改第19行的 `file_path` 参数。

### 数据要求
- 文件格式：Excel (.xlsx)
- 目标变量：二分类（0/1）
- 无需预先处理，程序会自动处理

## 各方法特点

### 1. Logistic回归 (logistic_regression_standalone.py)
**功能特色：**
- 单因素和多因素分析
- 统计显著性检验（P值）
- OR值和置信区间
- 多重共线性检验（VIF）
- 残差分析和诊断

**输出文件：**
- logistic_univariate_results.csv - 单因素分析结果
- logistic_predictions.csv - 预测结果
- logistic_vif.csv - VIF多重共线性检验
- logistic_regression_report.md - 分析报告
- logistic_roc_curve.png - ROC曲线
- logistic_diagnostics.png - 模型诊断图
- logistic_probability_distribution.png - 预测概率分布
- logistic_univariate_or.png - 单因素OR值图

### 2. 决策树 (decision_tree_standalone.py)
**功能特色：**
- 超参数自动调优
- 决策树可视化
- 决策规则提取
- 学习曲线分析
- 交叉验证评估

**输出文件：**
- decision_tree_feature_importance.csv - 特征重要性
- decision_tree_rules.txt - 决策规则
- decision_tree_report.md - 分析报告
- decision_tree_structure.png - 决策树结构
- decision_tree_roc_curve.png - ROC曲线
- decision_tree_learning_curve.png - 学习曲线
- decision_tree_parameter_tuning.png - 参数调优结果
- decision_tree_cv_results.png - 交叉验证结果
- decision_tree_feature_importance.png - 特征重要性图

### 3. 随机森林 (random_forest_standalone.py)
**功能特色：**
- 超参数自动调优
- 多种特征重要性评估（不纯度+排列）
- OOB评分
- 集成分析（预测一致性）
- 森林中树的分布分析

**输出文件：**
- random_forest_feature_importance.csv - 特征重要性
- random_forest_report.md - 分析报告
- random_forest_roc_curve.png - ROC曲线
- random_forest_learning_curve.png - 学习曲线
- random_forest_parameter_tuning.png - 参数调优结果
- random_forest_trees_distribution.png - 树的分布
- random_forest_tree_*.png - 森林中的树
- random_forest_ensemble_analysis.png - 集成分析
- random_forest_cv_results.png - 交叉验证结果
- random_forest_feature_importance.png - 特征重要性图

## 运行步骤

1. **准备数据**
   - 确保Excel文件在指定路径
   - 记住目标变量的列名

2. **选择方法**
   - 根据需求选择运行哪个文件
   - 可以依次运行三个方法进行对比

3. **输入目标变量**
   - 程序会先显示所有列名
   - 输入你要预测的目标变量列名

4. **查看结果**
   - 程序运行后会显示分析结果
   - 所有输出文件保存在当前目录

## 依赖安装

如果遇到模块缺失错误，请先安装依赖：

```bash
pip install pandas numpy matplotlib seaborn scikit-learn statsmodels scipy openpyxl
```

## 注意事项

1. **数据路径**：确保修改为你的实际数据路径
2. **目标变量**：必须是二分类变量（0/1）
3. **中文显示**：已设置中文字体，如遇显示问题请安装SimHei字体
4. **内存使用**：大数据集时可能需要较长时间进行网格搜索

## 故障排除

- **找不到文件**：检查数据文件路径是否正确
- **模块错误**：运行 `pip install -r requirements.txt`
- **编码错误**：确保Excel文件编码正确
- **内存不足**：可以减少网格搜索的参数范围

## 方法选择建议

- **Logistic回归**：需要统计推断和可解释性时
- **决策树**：需要清晰的决策规则时
- **随机森林**：追求最佳预测性能时

每个方法都是独立的，可以根据需要选择使用！