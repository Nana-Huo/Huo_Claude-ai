# 汉中市胆结石区域性风险调研数据处理计划

## 项目概述
- **研究主题**: 汉中市胆结石区域性风险调研
- **数据类型**: 问卷调研数据
- **目标变量**: 胆结石发病状态（二分类）
- **分析重点**: 风险因素识别、结果可视化、方法比较、区域特征分析

## 数据文件位置
- **原始数据**: `C:\Users\霍冠华\Desktop\毕设\数据处理\原始数据.xlsx`
- **工作目录**: `C:\Users\霍冠华\Documents\trae_projects\claude code`

## 实施步骤

### 第一阶段：数据准备与探索
1. **复制数据文件到工作区**
   - 将 `原始数据.xlsx` 复制到工作区
   - 路径：`C:\Users\霍冠华\Documents\trae_projects\claude code\原始数据.xlsx`

2. **数据探索与质量评估**
   - 使用 `analyze_data.py` 查看数据基本信息
   - 检查数据结构、变量类型、缺失值情况
   - 生成数据质量报告

### 第二阶段：数据预处理
1. **数据清洗**
   - 处理缺失值（删除缺失值过多的行）
   - 数值型变量用均值填充
   - 分类型变量用众数填充

2. **变量编码**
   - 识别分类变量
   - 使用LabelEncoder进行编码
   - 创建编码映射表

3. **数据标准化**
   - 对数值型变量进行标准化
   - 保留分类变量的原始编码

4. **构建标准化数据集**
   - 保存预处理后的数据
   - 生成数据字典

### 第三阶段：风险因素分析
1. **卡方检验**
   - 筛选与胆结石发病相关的潜在风险因素
   - 计算P值，识别显著因素（P<0.05）

2. **多因素Logistic回归**
   - 识别独立风险因素
   - 计算OR值和95%置信区间
   - 进行多重共线性检验（VIF）

3. **随机森林模型**
   - 训练随机森林模型
   - 进行特征重要性排序
   - 评估模型性能（准确率、AUC、OOB得分）

### 第四阶段：方法比较与综合分析
1. **模型性能比较**
   - 对比Logistic回归、决策树、随机森林的性能
   - 生成ROC曲线比较图
   - 计算各种评估指标

2. **特征重要性综合分析**
   - 整合不同方法的结果
   - 生成综合特征重要性排名
   - 识别核心风险因素

### 第五阶段：结果可视化
1. **基础可视化**
   - 数据分布图（直方图、箱线图）
   - 相关性热力图
   - 缺失值分布图

2. **模型结果可视化**
   - ROC曲线
   - 特征重要性柱状图
   - 混淆矩阵
   - 学习曲线

3. **区域特征可视化**
   - 汉中市胆结石主要风险因素空间分布图
   - 结合陕南饮食文化特点进行分析

### 第六阶段：报告生成
1. **Markdown报告**
   - 数据概览
   - 预处理流程说明
   - 分析方法介绍
   - 结果与讨论
   - 结论与建议

2. **数据文件输出**
   - 预处理后的数据（CSV格式）
   - 编码映射表
   - 分析结果汇总表

## 使用的工具和库
- **数据处理**: pandas, numpy
- **统计分析**: statsmodels, scipy
- **机器学习**: scikit-learn
- **可视化**: matplotlib, seaborn
- **现有工具**:
  - `analyze_data.py` - 数据探索
  - `comprehensive_analysis.py` - 综合分析
  - `logistic_regression_standalone.py` - Logistic回归
  - `decision_tree_standalone.py` - 决策树
  - `random_forest_standalone.py` - 随机森林

## 输出文件清单
1. `原始数据.xlsx` - 原始数据副本
2. `预处理数据.csv` - 预处理后的数据
3. `编码映射表.csv` - 变量编码对照
4. `数据质量报告.txt` - 数据质量评估
5. `卡方检验结果.csv` - 单因素分析结果
6. `Logistic回归结果.csv` - 多因素分析结果
7. `随机森林结果.csv` - 机器学习结果
8. `特征重要性排名.csv` - 综合特征重要性
9. `分析报告.md` - 完整分析报告
10. `可视化图表/` - 所有图表文件

## 注意事项
1. 目标变量需要明确指定（如"胆结石发病状态"或类似列名）
2. 分类变量需要正确识别和编码
3. 保持数据处理的完整性和可追溯性
4. 所有分析结果需要结合汉中市区域特点进行解释
5. 预防建议要具体、可操作

## 时间安排
- 数据准备与探索: 30分钟
- 数据预处理: 1小时
- 风险因素分析: 2小时
- 方法比较与综合分析: 1小时
- 结果可视化: 1小时
- 报告生成: 30分钟
- 总计: 约6小时